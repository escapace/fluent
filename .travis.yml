dist: xenial
addons:
  apt:
    packages:
    - dirmngr
before_install:
- npm install -g npm recce
install: npm install
script:
- npm run typecheck
- npm run lint
- npm run test
- npm run build
after_success:
- npx codecov
language: node_js
branches:
  only:
  - master
  - next
  - "/^renovate.*$/"
  - "/^new-.*$/"
  - "/^feat-.*$/"
  - "/^add-.*$/"
  - "/^change-.*$/"
  - "/^breaking-.*$/"
  - "/^deprecate-.*$/"
  - "/^remove-.*$/"
  - "/^fix-.*$/"
  - "/^sec-.*$/"
  - "/^security-.*$/"
  - "/^perf-.*$/"
  - "/^performance-.*$/"
  - "/^test-.*$/"
  - "/^tests-.*$/"
  - "/^chore-.*$/"
  - "/^docs-.*$/"
  - "/^style-.*$/"
  - "/^refactor-.*$/"
  - "/^v?\\d+\\.\\d+\\.\\d+.*$/"
  - "/^\\d+\\.\\d+\\.\\d+.*$/"
cache:
  directories:
  - "$HOME/.npm"
notifications:
  email: false
node_js:
- node
jobs:
  include:
  - stage: release
    node_js: lts/*
    deploy:
      provider: script
      skip_cleanup: true
      script:
      - npx semantic-release
env:
  global:
  - secure: E5roAVkeLMXMiO9ZoCazvkO29AXPJKlsKCJLIFIvt/qUMqZywTZvKqRjgdcZSMeS4q7IVkDYAq9bHwRhiud37AglD/L/7U5DqE8reKWVwAFFDiTqzbDu984/zrQooyoVdIVRLkyELU74cp2Vb892C3+rgsoJhdbtUPnnoDO1RV+SH39mB6RL5ofRGhiBbfeKGENrvQY29EtntE41UUMLSZiQO5begzseTRy/RxC/G38B9OVRBuKQuAob2Tirr9uQubJJe7KfsnTDhCPiOE3fsiToqToQ/Jn7pd4V9hb1IniEc8ROOGkivGcggpFbgSabMhtMa18cT4UYJ4BfysHcBGa3bmrrimsGESi/omNEv/7B/5pHGlAF1N6HYtv4jBdr3OqdAETyrn9P9xRjPE4cquKbrzXjtlopTgrUVyYn4Th4tZ8M7xVeFhJW1Mt6AqRsHLZ4VL4rKOqdzVAMWjJAxyRI1OndgRbn61fMrfSt4hXrGby9AFyHH+JDJhHm9vm8lTSEdKByyeulxQhAbymjC+ZrFilBFsithI99D2kSvevhfAULMgYocwL0TUbmkrSAWsjMvhBT4XamE5a13iz9D+s+N/Q4ZAj9rkkNzAYJtDp5ksIpaLjZNtjnnYwetmdReerz26DGr2XrQj8BHmFTOjuNjowRji7LDCGLW7ejHAk=
  - secure: PI9AmX4hJwm/8EzL2Zp+Jkyqtx3cZ4fAQmniJtyy6YfAHhec/wgXXQpSjo+W5cFTS8OOseLGr5mm3OsxOjfr1TZKTNJ68CTociNd1TvzlJwLeyuMvlH5H6LOfE4xIOL/Hly5imapDI45PjsAsDjfqra2nAQ8Acvh6Oy+V5CQ8w+Zv5yHighoitgdkBnSAkksRkuNwdnxJj4SMiM/KV23YiQPA0H0DJ9ylTq0FLZ2rfIAb00ulc7EyAKLdT5VQYyKPel2kWr6pz28T8Olqu0WZYBmy5DGHkMKZSfGYiTW7Clnv8sdlI/X8+U2jZ32wJm33X2DQhxTav8XebKAMQdnSqoEIAdtb0kDHA6HeBz/RgwNbcFyB+XAojKzgbntoqW264bXd/Xy0wv4TT4HDhRZctM/qC4q9CRef0Coqb35W599Nvh0izkekrxeFnDLXCsla4IWvX2bdmChKME/sYfVvxCPMIDLyk2zg7WQNgbPF8NKEB3sJm8C/3I6m2eBneL+XhqKcNDRVSmkuXC5GbqspKTL7r5AgpDxvP2d0aYkS5ZkDi/LQxcTaotVcGGK4koKUoRSDtS/bQozEdPuT1O2bPHNi1fG88Z8UJhYanz8Kc85MOkWW+bFes/6Xu8PM06oweqj5C+c5sldnsgKeDP5TtILnJBe/9Xyr8rJNamCKHY=
